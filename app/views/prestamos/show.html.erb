<p id="notice"><%= notice %></p>
<div class= "d-flex barra-container">
    <div class = "card-container">
      <div class = "text-center">
      <h1><%="Préstamo #{@prestamo.fecha}"%></h1>
    </div>
    <div class = "d-flex justify-content-center">
      <div class = "text-center m-3">
        <%= link_to 'Edita', edit_prestamo_path(@prestamo), :class => "btn btn-primary btn-lg" %>
      </div>
      <div class = "text-center m-3">
        <%= link_to 'Contrato de préstamo', contratoprestamo_path(:format => :pdf), :class => "btn btn-primary btn-lg", target: :_blank %>
      </div>
    </div>

    <div class = "sale-card d-flex justify-content-around align-items-center">
      <% if @prestamo.contrato.attached? %>
        <div>
          <strong>Contrato:</strong>
          <%= link_to("Descargar", cl_image_path("#{@prestamo.contrato.key}.pdf")) %>
        </div>
      <% end %>
      <% if @prestamo.modelo.attached? %>
        <div>
          <strong>Modelo 600:</strong>
          <%= link_to("Descargar", cl_image_path("#{@prestamo.modelo.key}.pdf")) %>
        </div>
      <% end %>
      <% if @prestamo.diligencia.attached? %>
        <div>
          <strong>Diligencia:</strong>
          <%= link_to("Descargar", cl_image_path("#{@prestamo.diligencia.key}.pdf")) %>
        </div>
      <% end %>
    </div>
    <div class = "sale-card">
      <div class = "d-flex justify-content-between align-items-baseline">
        <h3><strong>Préstamo nº</strong></h3>
        <h3><%= @prestamo.fecha %></h3>
      </div>

      <p>
        <strong>Cantidad:</strong>
        <%= @prestamo.cantidad %>€
      </p>

      <p>
        <strong>Interes:</strong>
        <%= @prestamo.interes %>%
      </p>

       <p>
        <strong>Intereses:</strong>
        <%= @prestamo.interesnominal %>€
      </p>

      <p>
        <strong>Prestamista:</strong>
        <%= "#{@prestamo.prestamista.nombre} #{@prestamo.prestamista.apellido}" %>
        <%= link_to "Abrir", @prestamo.prestamista%></td>
      </p>

      <p>
        <strong>Prestatario:</strong>
        <%= "#{@prestamo.prestatario.nombre} #{@prestamo.prestatario.apellido}" %>
        <%= link_to "Abrir", @prestamo.prestatario%></td>

      </p>
    </div>
    <%# <div class = "sale-card"> %>
      <div class = "sale-card1">
        <div class = "d-flex justify-content-between">
        <h3><%= @prestamo.total_bruto %>€ - A retener: <%= @prestamo.retencion %> </h3>
          <%# <% if @sale.pendiente_cobro == 0 %>
            <%# <h3 class = "text-center green"> Pagado</h3> %>
          <%# <% else %>
            <%# <h3 class = "text-center"> Pendiente: <%= @sale.pendiente_cobro%>
          <%# <% end %>
          <%= link_to " + ", new_flujo_path(:prestamo_id => @prestamo.id), :class => "añadido" %>
        </div>
        <table class = "table mt-4">
          <tr>
            <th>Pago</th>
            <th>Cantidad</th>
            <th>Fecha</th>
            <th>X</th>
          </tr>
          <% @prestamo.flujos.each do |cobro| %>
          <tr>
            <% unless cobro.fecha_efectiva == nil %>
              <td><%= link_to 'Si', edit_flujo_path(cobro), :class => "text_none" %></td>
            <% else %>
              <td><%= link_to 'No', edit_flujo_path(cobro), :class => "text_none" %></td>
            <% end %>
              <td><%= cobro.cantidad %>€</td>
              <td><%= cobro.fecha_teorica.strftime('%d-%m-%Y') %></td>
              <td><%= link_to 'x', cobro, method: :delete, data: { confirm: 'Are you sure?' }, :class => "text_none" %></td>
          </tr>
          <% end %>
        </table>
        <h3>Pendiente: <%= @prestamo.pendiente %> </h3>
      </div>
    <%# </div> %>

</div>
